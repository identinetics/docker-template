# Docker Scripts - a simple image and container management

A git subproject for docker projects. Provides scripts for docker build, exec and run commands that
are becoming unwiedly when one needs many arguments. Tries to be a thin wrapper around the
docker CLI similar to docker-compose, with a focus to control the mapping of uids to the docker host.

Features:

- By default, containers do not run as root, but have unique users mapped to the docker host
- The image produces immutable containers, i.e. a container can be removed and re-created
  any time without loss of data, because data is stored on mounted volumes.
- Configuration from a config file, building and running containers with the same script in
  different projects
- Consistent image, container, user and network mapping for multiple containers
- Download archives or clone github repos before `ocker build` to have better control on updates

## Configuration

1. Add this project to your docker project as a subdirectory or git submodule, e.g.

    git submodule add https://github.com/identinetics/dscripts.git
    git commit -m 'add submodule dscripts'
    # later, when you clone your project, you need to execute:    
    git submodule init && git submodule update
    cd dscripts && git checkout master && cd ..
    
2. From the dscript project copy default files into your project root:

    cp dscript/Dockerfile.default Dockerfile
    cp dscript/conf.sh.default confXX.sh  # set XX to a unique 2-digit number on your host
    # optional
    cp dscript/build_prepare.sh.default build_prepare.sh 
    cp dscript/.gitignore .
    cp -r dscript/install .
    
    
3. adapt Dockerfile, conf.sh and build_prepare.sh

## Usage

    dscript/build.sh [-h] [-n] [-p] [-r]
    dscript/run.sh [-h] [-i] [-n container-nr] [-p] [-r] -[R] [cmd]
    dscript/exec.sh [-h] [-i] [-n] [-p] [-r] [cmd]
    
   To run multiple XYZ containers on the same system you need to create separate 
   conf.sh files and build separate images:
   E.g. to create XYZ container instance 3:
   a) create a file conf3.sh, and set the IMGID=3; and
   b) build the container with the -n option, e.g. `build.sh -n 3`
   c) run the container with the -n option, e.g. `run.sh -n 3`

## Alternatives

- Do not map Volumes to the docker host, but use other docker storage options. Handle container
  startup with docker-compose.